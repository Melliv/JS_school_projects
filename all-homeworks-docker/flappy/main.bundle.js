(()=>{"use strict";const t=function(){function t(t,i,e){this.birdCells=[],this.moveDown=!0,this.set=e,this.width=Math.floor(i*this.set.BIRD_HEIGHT),this.height=Math.floor(t*this.set.BIRD_WIDTH),this.jumpRep=this.set.JUMP_REPETITION,this.BIRD_START_LOCATION_X=Math.floor(i*this.set.BIRD_START_POINT_X),this.BIRD_END_LOCATION_X=this.BIRD_START_LOCATION_X+this.width,this.BIRD_START_LOCATION_Y=Math.floor(t*this.set.BIRD_START_POINT_Y),this.BIRD_END_LOCATION_Y=this.BIRD_START_LOCATION_Y+this.height,this.makeBird()}return t.prototype.makeBird=function(){if(8===this.width&&8===this.height)this.birdCells=this.set.BIRD_8x8;else if(16===this.width&&12===this.height)this.birdCells=this.set.BIRD_16x12;else for(var t=0;t<this.width;t++){for(var i=[],e=0;e<this.height;e++)i.push(this.set.YELLOW);this.birdCells.push(i)}},t.prototype.moveBird=function(){this.moveDown?(this.BIRD_START_LOCATION_Y++,this.BIRD_END_LOCATION_Y++):(this.BIRD_START_LOCATION_Y-=this.set.JUMP_WIDTH,this.BIRD_END_LOCATION_Y-=this.set.JUMP_WIDTH,this.jumpRep--,0===this.jumpRep&&(this.moveDown=!0,this.jumpRep=this.set.JUMP_REPETITION))},t.prototype.jump=function(){this.moveDown=!1},t.prototype.getLocation=function(){return[this.BIRD_START_LOCATION_X,this.BIRD_END_LOCATION_X,this.BIRD_START_LOCATION_Y,this.BIRD_END_LOCATION_Y]},t.prototype.getBirdCell=function(t,i){return this.birdCells[t][i]},t}(),i=function(){this.ROW_COUNT=100,this.COL_COUNT=100,this.RENDER_SPEED=50,this.OBSTACLE_STEP=60,this.OBSTACLE_WIDTH=8,this.GATE_SIZE=.4,this.JUMP_REPETITION=10,this.JUMP_WIDTH=3,this.BIRD_WIDTH=.08,this.BIRD_HEIGHT=.08,this.BIRD_START_POINT_X=.25,this.BIRD_START_POINT_Y=.5,this.GREEN=-1,this.BLUE=0,this.YELLOW=1,this.ORANGE=2,this.RED=3,this.WHITE=4,this.BLACK=5,this.BIRD_8x8=[[0,0,1,1,2,2,0,0],[0,1,1,2,2,2,2,0],[1,1,1,2,2,2,2,1],[1,1,1,2,2,2,2,1],[1,1,1,1,1,1,1,1],[0,4,4,1,3,3,1,1],[0,5,5,1,3,3,1,0],[0,0,0,0,3,3,0,0]],this.BIRD_16x12=[[0,0,0,0,5,5,5,0,0,0,0,0],[0,0,0,5,4,4,1,5,0,0,0,0],[0,0,0,5,4,4,4,1,5,5,0,0],[0,0,5,4,4,4,4,1,5,2,5,0],[0,5,4,5,4,4,4,1,5,2,5,0],[0,5,4,1,5,4,1,5,2,2,2,5],[5,4,1,1,1,5,5,1,2,2,2,5],[5,4,1,1,1,1,1,1,2,2,2,5],[5,4,5,5,5,1,1,1,5,2,2,5],[5,5,4,4,4,5,1,5,3,5,2,5],[5,4,4,4,4,4,5,3,5,3,5,0],[5,4,4,4,4,4,5,3,5,3,5,0],[0,5,4,5,5,4,5,3,5,3,5,0],[0,0,5,4,4,4,5,3,5,3,5,0],[0,0,0,5,5,5,5,3,5,3,5,0],[0,0,0,0,0,0,0,5,5,5,0,0]]};var e=function(t,i){this.name=t,this.score=i},o=function(){function o(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.scoreBoard=[],this.bird=null,this.step=0,this.obsWidthCou=0,this.shiftCou=0,this.score=0,this.obstacleHolder=[],this.board=[],this.set=new i,this.rowCount=0===t?this.set.ROW_COUNT:t,this.colCount=0===e?this.set.COL_COUNT:e,this.intializeBoard()}return o.prototype.intializeBoard=function(){this.bird=new t(this.rowCount,this.colCount,this.set);for(var i=0;i<this.colCount;i++)this.board.push(this.createClearCol())},o.prototype.resetGame=function(){this.step=0,this.obsWidthCou=0,this.shiftCou=0,this.score=0,this.obstacleHolder=[],this.board=[],this.intializeBoard()},o.prototype.createClearCol=function(){for(var t=[],i=0;i<this.rowCount;i++)t.push(this.set.BLUE);return t},o.prototype.createObstacleCol=function(){for(var t=[],i=this.randomizeGate(),e=0;e<this.rowCount;e++)i[0]<=e&&e<=i[1]?t.push(this.set.BLUE):t.push(this.set.GREEN);return t},o.prototype.randomizeGate=function(){var t=this.rowCount*this.set.GATE_SIZE,i=Math.floor(Math.random()*(this.rowCount-t-2));return[i,i+t]},o.prototype.insertScore=function(t){this.scoreBoard.push(new e(t,this.score))},o.prototype.shiftBoard=function(){this.bird.moveBird(),this.board.shift(),this.calculateScore(),0===this.step?(this.obstacleHolder=this.createObstacleCol(),this.board.push(this.obstacleHolder),this.obsWidthCou=0,this.step=this.set.OBSTACLE_STEP):this.step===this.set.OBSTACLE_STEP&&this.obsWidthCou<this.set.OBSTACLE_WIDTH?(this.board.push(this.obstacleHolder),this.obsWidthCou++):(this.board.push(this.createClearCol()),this.step--)},o.prototype.calculateScore=function(){this.shiftCou++,(0===this.score&&this.shiftCou>this.colCount*(1-this.set.BIRD_START_POINT_X)||this.score>0&&this.shiftCou>this.set.OBSTACLE_STEP+this.set.OBSTACLE_WIDTH)&&(this.shiftCou=0,this.score++)},o.prototype.birdCrash=function(){for(var t=this.getBirdLocation(),i=t[2];i<t[3];i++)if(this.board[t[1]-1][i]===this.set.GREEN)return!0;for(var e=t[0];e<t[1];e++)if(this.board[e][t[2]]===this.set.GREEN||this.board[e][t[3]]===this.set.GREEN)return!0;return t[2]<=0||t[3]===this.colCount},o.prototype.birdJump=function(){this.bird.jump()},o.prototype.getRowCount=function(){return this.rowCount},o.prototype.getColCount=function(){return this.colCount},o.prototype.getSettings=function(){return this.set},o.prototype.getBirdCell=function(t,i){return this.bird.getBirdCell(t,i)},o.prototype.getBirdLocation=function(){return this.bird.getLocation()},o.prototype.getGameBoard=function(){return this.board},o.prototype.getGameBoardLastCol=function(){return this.board[this.board.length-1]},o.prototype.getScore=function(){return this.score},o.prototype.getScoreBoard=function(){return this.scoreBoard},o}();const s=function(){function t(t,i){this.birdLocation=[],this.isRunning=!1,this.timer=null,this.rowHeight=0,this.colWidth=0,this.viewContainer=t,this.model=i,this.set=i.getSettings()}return t.prototype.run=function(){this.displayBoard(),this.birdLocation=this.model.getBirdLocation(),this.drawBird(),this.animateGame()},t.prototype.startModel=function(){this.model.resetGame()},t.prototype.displayBoard=function(){this.isRunning=!0,this.viewContainer.innerHTML="",this.viewContainer.append(this.getBoardHtml())},t.prototype.birdJump=function(){this.model.birdJump()},t.prototype.stop=function(){this.isRunning=!1,clearTimeout(this.timer)},t.prototype.animateGame=function(){var t=this;this.timer=setTimeout((function(){t.shiftBoard(),t.showScore(),t.animateGame()}),this.set.RENDER_SPEED)},t.prototype.shiftBoard=function(){this.model.shiftBoard(),this.removeFirstCol();var t=this.getCol(this.model.getGameBoardLastCol());if(this.viewContainer.firstElementChild.append(t),this.model.birdCrash()){var i=prompt("Insert your name");null!=i&&this.model.insertScore(i),this.startModel(),this.displayBoard()}else this.shiftBird()},t.prototype.shiftBird=function(){this.eraseBird(),this.drawBird()},t.prototype.eraseBird=function(){for(var t=this.viewContainer.firstElementChild.childNodes,i=this.birdLocation[0]-1;i<this.birdLocation[1]-1;i++)for(var e=this.birdLocation[2];e<this.birdLocation[3];e++)t[i].childNodes[e].style.backgroundColor=this.getCellColor(this.set.BLUE)},t.prototype.drawBird=function(){this.birdLocation=this.model.getBirdLocation();for(var t=0,i=this.viewContainer.firstElementChild.childNodes,e=this.birdLocation[0];e<this.birdLocation[1];e++){for(var o=0,s=this.birdLocation[2];s<this.birdLocation[3];s++)i[e].childNodes[s].style.backgroundColor=this.getCellColor(this.model.getBirdCell(t,o)),o++;t++}},t.prototype.showScore=function(){document.getElementById("scoreElem").textContent=this.model.getScore().toString()},t.prototype.removeFirstCol=function(){this.viewContainer.firstElementChild.firstElementChild.remove()},t.prototype.getBoardHtml=function(){var t=this,i=document.createElement("div");return i.id="gameboard",this.calculateBlockSize(),this.model.getGameBoard().forEach((function(e){i.append(t.getCol(e))})),i},t.prototype.calculateBlockSize=function(){this.rowHeight=(window.innerHeight-document.getElementById("control").clientHeight-4)/this.model.getRowCount(),this.colWidth=window.innerWidth/this.model.getColCount()},t.prototype.getCol=function(t){var i=this,e=document.createElement("div");return e.style.minWidth=this.colWidth+"px",e.style.maxWidth=this.colWidth+"px",e.style.display="inline-block",t.forEach((function(t){e.append(i.getCell(t))})),e},t.prototype.getCell=function(t){var i=document.createElement("div");return i.style.backgroundColor=this.getCellColor(t),i.style.minWidth=this.colWidth+"px",i.style.minHeight=this.rowHeight+"px",i},t.prototype.getCellColor=function(t){switch(t){case this.set.BLUE:return"#0099ff";case this.set.GREEN:return"#006600";case this.set.YELLOW:return"#ffff00";case this.set.ORANGE:return"#f5b342";case this.set.RED:return"#f54242";case this.set.WHITE:return"#ffffff";case this.set.BLACK:return"#000000";default:return"#111111"}},t.prototype.resizeUi=function(){this.isRunning&&this.displayBoard()},t}(),n=function(){function t(t,i){this.isRunning=!1,this.viewContainer=t,this.model=i}return t.prototype.run=function(){this.isRunning=!0,this.viewContainer.innerHTML="",this.makeScoreTable()},t.prototype.makeScoreTable=function(){var t=document.createElement("table"),i=document.createElement("th"),e=document.createElement("th");i.textContent="score",e.textContent="name",i.style.width="100px",e.style.width="100px",t.append(i),t.append(e),this.model.getScoreBoard().forEach((function(i){var e=document.createElement("tr"),o=document.createElement("td"),s=document.createElement("td");o.textContent=i.score.toString(),s.textContent=i.name,e.append(o),e.append(s),t.append(e)})),t.style.margin="auto",t.style.fontSize="200%",this.viewContainer.append(t)},t.prototype.stop=function(){this.isRunning=!1},t.prototype.resizeUi=function(){this.isRunning},t}();var r,h=new o,a=function(){document.body.style.background="#99cc00";var t=document.createElement("div");return t.id="view-container",t.style.textAlign="center",t.style.alignContent="center",t}(),d=new s(a,h),c=new n(a,h),u=((r=document.createElement("div")).id="main",r);document.body.append(u);var l=function(t){var i=document.createElement("div");i.style.textAlign="center",i.style.background="#006666",i.id="control";var e=document.createElement("button");e.id="statistics",e.innerText="Statistics";var o=document.createElement("button");o.id="game",o.innerText="Game",o.style.marginLeft="3%",o.style.marginRight="3%";var s=document.createElement("span");s.textContent="Score:";var n=document.createElement("span");return n.id="scoreElem",n.style.fontWeight="bold",i.append(e),i.append(o),i.append(s),i.append(n),e.addEventListener("click",(function(){t(e)})),o.addEventListener("click",(function(){t(o)})),i}((function(t){t.blur(),"game"===t.id?(c.stop(),d.stop(),d.startModel(),d.run()):"statistics"===t.id&&(d.stop(),c.run())}));u.append(l),u.append(a),window.addEventListener("resize",(function(){d.resizeUi()})),window.addEventListener("keyup",(function(){d.birdJump()})),c.run()})();